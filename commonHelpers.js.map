{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["//! У файлі pixabay-api.js зберігаються функції для HTTP-запитів.\n\nimport axios from 'axios';\n\n// const для pixabay\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '43217823-e472439c26018cf28ab0cff6b';\n\nexport default async function fetchData(query, page) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    // query = searchInput.value.trim()\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page,\n  });\n\n  const response = await axios.get(`${BASE_URL}?${params}`);\n  return response.data;\n}\n","//! У файлі render-functions.js - функції для відображення елементів інтерфейсу.\n\nexport default function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"li-js\">\n    <a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"155\"/>\n    </a>\n        <ul class=\"characteristics\">\n            <li>Likes<br> <span class=\"span\">${likes}</span></li>\n            <li>Views<br> <span class=\"span\">${views}</span></li>\n            <li>Comments<br> <span class=\"span\">${comments}</span></li>\n            <li>Downloads<br> <span class=\"span\">${downloads}</span></li>\n        </ul>\n    </li>`;\n      }\n    )\n    .join('');\n}\n","//! У файлі main.js знаходиться вся логіка роботи додатка.\n\n// Бібліотека Axios\nimport axios from 'axios';\n\n// import з pixabay-api\nimport fetchData from '../src/js/pixabay-api';\n\n// import з render-functions\nimport createMarkup from '../src/js/render-functions';\n\n// SimpleLightbox\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst lightbox = new SimpleLightbox('.list a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\n// iziToast\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Пошук елементів форми та список, кнопки Load more\nconst searchForm = document.querySelector('.search-form');\nconst searchLoading = document.querySelector('.loader');\nexport const searchInput = document.querySelector('.search-input');\nconst list = document.querySelector('ul');\nconst loadMoreButton = document.querySelector('.load-more-button');\n\n// page\nlet page = 1;\nlet perPage = 15;\n\n// handleSubmit\nasync function handleSubmit(event) {\n  event.preventDefault();\n  page = 1;\n  // console.log(page);\n\n  if (searchInput.value.trim() === '') {\n    return;\n  }\n\n  list.innerHTML = '';\n  loadMoreButton.classList.add('load-more-hidden');\n  createLoader();\n\n  try {\n    const data = await fetchData(searchInput.value.trim(), page);\n    list.innerHTML = ''; // Очищення попередніх результатів перед вставкою нових\n    list.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n\n    lightbox.refresh();\n\n    if (data.hits.length === 0) {\n      loadMoreButton.classList.add('load-more-hidden');\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        color: 'red',\n        position: 'topRight',\n      });\n    } else if (data.totalHits <= perPage) {\n      loadMoreButton.classList.add('load-more-hidden');\n    } else {\n      loadMoreButton.classList.remove('load-more-hidden');\n    }\n\n    removeLoader();\n  } catch (error) {\n    alert(error);\n  }\n}\n\n// Додаємо слухача події на форму\nsearchForm.addEventListener('submit', handleSubmit);\n\n// Додаємо слухача події на кнопку Load more\nloadMoreButton.addEventListener('click', handleLoadMore);\n\n// handleLoadMore\nasync function handleLoadMore() {\n  page += 1;\n  // console.log(page);\n\n  createLoader();\n  loadMoreButton.disabled = true;\n\n  try {\n    const data = await fetchData(searchInput.value.trim(), page);\n    removeLoader();\n\n    list.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    lightbox.refresh();\n    loadMoreButton.disabled = false;\n\n    // Отримання висоти\n    const cardHeight = list\n      .querySelector('.li-js')\n      .getBoundingClientRect().height;\n    // console.log(cardHeight);\n\n    // Плавна прокрутка сторінки\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    // console.log('total hits', data.totalHits);\n    const totalPages = Math.ceil(data.totalHits / perPage);\n\n    // Перевірка кінця колекції\n    if (page >= totalPages) {\n      loadMoreButton.classList.add('load-more-hidden'); // Додаємо клас, який приховує кнопку \"Load more\"\n      iziToast.info({\n        title: '',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    alert(error.message);\n  }\n}\n\n// Функція для створення елемента loader\nexport function createLoader() {\n  searchLoading.classList.remove('none');\n}\n\n// Функція для видалення елемента loader\nexport function removeLoader() {\n  searchLoading.classList.add('none');\n}\n"],"names":["BASE_URL","API_KEY","fetchData","query","page","params","axios","createMarkup","arr","largeImageURL","webformatURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","searchForm","searchLoading","searchInput","list","loadMoreButton","perPage","handleSubmit","event","createLoader","data","iziToast","removeLoader","error","handleLoadMore","cardHeight","totalPages"],"mappings":"+vBAAA;AAKA,MAAMA,EAAW,2BACXC,EAAU,qCAED,eAAeC,EAAUC,EAAOC,EAAM,CACnD,MAAMC,EAAS,IAAI,gBAAgB,CACjC,IAAKJ,EACL,EAAGE,EAEH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAC,CACJ,CAAG,EAGD,OADiB,MAAME,EAAM,IAAI,GAAGN,CAAQ,IAAIK,CAAM,EAAE,GACxC,IAClB,CCtBA;AAEe,SAASE,EAAaC,EAAK,CACxC,OAAOA,EACJ,IACC,CAAC,CACC,cAAAC,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,eACAN,CAAa;AAAA,oBACRC,CAAY,UAAUC,CAAI;AAAA;AAAA;AAAA,+CAGCC,CAAK;AAAA,+CACLC,CAAK;AAAA,kDACFC,CAAQ;AAAA,mDACPC,CAAS;AAAA;AAAA,UAIvD,EACA,KAAK,EAAE,CACZ,CC5BA;AAcA,MAAMC,EAAW,IAAIC,EAAe,UAAW,CAC7C,aAAc,MACd,gBAAiB,SACjB,aAAc,IACd,eAAgB,EAClB,CAAC,EAOKC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAgB,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,eAAe,EAC3DC,EAAO,SAAS,cAAc,IAAI,EAClCC,EAAiB,SAAS,cAAc,mBAAmB,EAGjE,IAAIlB,EAAO,EACPmB,EAAU,GAGd,eAAeC,EAAaC,EAAO,CAKjC,GAJAA,EAAM,eAAc,EACpBrB,EAAO,EAGHgB,EAAY,MAAM,KAAI,IAAO,GAIjC,CAAAC,EAAK,UAAY,GACjBC,EAAe,UAAU,IAAI,kBAAkB,EAC/CI,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMzB,EAAUkB,EAAY,MAAM,KAAI,EAAIhB,CAAI,EAC3DiB,EAAK,UAAY,GACjBA,EAAK,mBAAmB,YAAad,EAAaoB,EAAK,IAAI,CAAC,EAE5DX,EAAS,QAAO,EAEZW,EAAK,KAAK,SAAW,GACvBL,EAAe,UAAU,IAAI,kBAAkB,EAC/CM,EAAS,KAAK,CACZ,QACE,2EACF,MAAO,MACP,SAAU,UAClB,CAAO,GACQD,EAAK,WAAaJ,EAC3BD,EAAe,UAAU,IAAI,kBAAkB,EAE/CA,EAAe,UAAU,OAAO,kBAAkB,EAGpDO,GACD,OAAQC,EAAO,CACd,MAAMA,CAAK,CACZ,EACH,CAGAZ,EAAW,iBAAiB,SAAUM,CAAY,EAGlDF,EAAe,iBAAiB,QAASS,CAAc,EAGvD,eAAeA,GAAiB,CAC9B3B,GAAQ,EAGRsB,IACAJ,EAAe,SAAW,GAE1B,GAAI,CACF,MAAMK,EAAO,MAAMzB,EAAUkB,EAAY,MAAM,KAAI,EAAIhB,CAAI,EAC3DyB,IAEAR,EAAK,mBAAmB,YAAad,EAAaoB,EAAK,IAAI,CAAC,EAC5DX,EAAS,QAAO,EAChBM,EAAe,SAAW,GAG1B,MAAMU,EAAaX,EAChB,cAAc,QAAQ,EACtB,sBAAqB,EAAG,OAI3B,OAAO,SAAS,CACd,IAAKW,EAAa,EAClB,SAAU,QAChB,CAAK,EAGD,MAAMC,EAAa,KAAK,KAAKN,EAAK,UAAYJ,CAAO,EAGjDnB,GAAQ6B,IACVX,EAAe,UAAU,IAAI,kBAAkB,EAC/CM,EAAS,KAAK,CACZ,MAAO,GACP,QAAS,6DACT,SAAU,UAClB,CAAO,EAEJ,OAAQE,EAAO,CACd,MAAMA,EAAM,OAAO,CACpB,CACH,CAGO,SAASJ,GAAe,CAC7BP,EAAc,UAAU,OAAO,MAAM,CACvC,CAGO,SAASU,GAAe,CAC7BV,EAAc,UAAU,IAAI,MAAM,CACpC"}